<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started &mdash; MapDB</title>
    
    <link rel="stylesheet" href="../_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MapDB" href="../index.html" />
    <link rel="up" title="MapDB Manual" href="index.html" />
    <link rel="next" title="DB and DBMaker" href="db-and-dbmaker.html" />
    <link rel="prev" title="Foreword" href="foreword.html" />
  
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

<!-- google analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42074659-1', 'auto');
  ga('send', 'pageview');

</script>

  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.post-list-style-disc {list-style-type: disc;}
    ul.post-list-style-none {list-style-type: none;}
    ul.post-list-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="#">Intro</a></li>
    <li><a href="index.html">Docs</a></li>
    <li><a href="/blog.html">Blog</a></li>
    <li><a href="https://github.com/jankotek/mapdb">Github</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="MapDB" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="db-and-dbmaker.html" title="DB and DBMaker"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="foreword.html" title="Foreword"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Home</a>&nbsp;|</li>
        <li><a href="../contents.html">Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">MapDB Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="document">
    <div class="documentwrapper">
        <div class="bodywrapper">
            <div class="body" role="main">
                
  <div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>MapDB has very power-full API, but for 99% of cases you need just two
classes:
<a class="reference external" href="http://www.mapdb.org/apidocs/org/mapdb/DBMaker.html">DBMaker</a> is a
builder style factory for configuring and opening a database. It has a
handful of static <code class="docutils literal"><span class="pre">newXXX</span></code> methods for particular storage mode.
<a class="reference external" href="http://www.mapdb.org/apidocs/org/mapdb/DB.html">DB</a> represents
storage. It has methods for accessing Maps and other collections. It
also controls the DB life-cycle with commit, rollback and close methods.</p>
<p>The best places to checkout various features of MapDB are
<a class="reference external" href="https://github.com/jankotek/MapDB/tree/master/src/test/java/examples">Examples</a>.
There is also
<a class="reference external" href="http://www.youtube.com/watch?v=FdZmyEHcWLI">screencast</a> which
describes most aspects of MapDB.</p>
<p>There is <a class="reference download internal" href="../_downloads/cheatsheet.pdf"><code class="xref download docutils literal"><span class="pre">MapDB</span> <span class="pre">Cheat</span> <span class="pre">Sheet</span></code></a>,
a quick reminder of the MapDB capabilities on just two pages.</p>
<div class="section" id="maven">
<h2>Maven<a class="headerlink" href="#maven" title="Permalink to this headline">¶</a></h2>
<p>MapDB is in Maven Central. Just add the code bellow to your pom file to use
it and replace VERSION. Latest version number and binary jars can be found in
<a class="reference external" href="http://mvnrepository.com/artifact/org.mapdb/mapdb">Maven central</a>.</p>
<p>There are two generations of MapDB, old 1.0 and newer 2.0. At this point I would recommend to use
2.0, despite its still beta, because it seems to be more robust.</p>
<div class="code xml highlight-python"><div class="highlight"><pre>&lt;dependency&gt;
    &lt;groupId&gt;org.mapdb&lt;/groupId&gt;
    &lt;artifactId&gt;mapdb&lt;/artifactId&gt;
    &lt;version&gt;VERSION&lt;/version&gt;
&lt;/dependency&gt;
</pre></div>
</div>
<p>We are working on the new generation of MapDB. It is faster and more reliable. The latest semi-stable build is at
<a class="reference external" href="https://oss.sonatype.org/content/repositories/snapshots/org/mapdb/mapdb/">snapshot repository</a>:</p>
<div class="code xml highlight-python"><div class="highlight"><pre>&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;sonatype-snapshots&lt;/id&gt;
        &lt;url&gt;https://oss.sonatype.org/content/repositories/snapshots&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mapdb&lt;/groupId&gt;
        &lt;artifactId&gt;mapdb&lt;/artifactId&gt;
        &lt;version&gt;2.0.0-SNAPSHOT&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</pre></div>
</div>
</div>
<div class="section" id="hello-world">
<h2>Hello World<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h2>
<p>Hereafter is a simple example. It opens TreeMap backed by a file in temp
directory. The file is discarded after JVM exits:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="c1">// import org.mapdb.*;</span>
<span class="n">ConcurrentNavigableMap</span> <span class="n">treeMap</span> <span class="o">=</span> <span class="n">DBMaker</span><span class="o">.</span><span class="na">tempTreeMap</span><span class="o">();</span>

<span class="c1">// and now use disk based Map as any other Map</span>
<span class="n">treeMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">111</span><span class="o">,</span><span class="s">&quot;some value&quot;</span><span class="o">);</span>
</pre></div>
</div>
<p>This is a more advanced example, with configuration and write-ahead-log
transaction.</p>
<div class="highlight-java"><div class="highlight"><pre><span class="c1">// import org.mapdb.*;</span>

<span class="c1">// configure and open database using builder pattern.</span>
<span class="c1">// all options are available with code auto-completion.</span>
<span class="n">DB</span> <span class="n">db</span> <span class="o">=</span> <span class="n">DBMaker</span><span class="o">.</span><span class="na">fileDB</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&quot;testdb&quot;</span><span class="o">))</span>
        <span class="o">.</span><span class="na">closeOnJvmShutdown</span><span class="o">()</span>
        <span class="o">.</span><span class="na">encryptionEnable</span><span class="o">(</span><span class="s">&quot;password&quot;</span><span class="o">)</span>
        <span class="o">.</span><span class="na">make</span><span class="o">();</span>

<span class="c1">// open existing an collection (or create new)</span>
<span class="n">ConcurrentNavigableMap</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="na">treeMap</span><span class="o">(</span><span class="s">&quot;collectionName&quot;</span><span class="o">);</span>

<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;one&quot;</span><span class="o">);</span>
<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="s">&quot;two&quot;</span><span class="o">);</span>
<span class="c1">// map.keySet() is now [1,2]</span>

<span class="n">db</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>  <span class="c1">//persist changes into disk</span>

<span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="s">&quot;three&quot;</span><span class="o">);</span>
<span class="c1">// map.keySet() is now [1,2,3]</span>
<span class="n">db</span><span class="o">.</span><span class="na">rollback</span><span class="o">();</span> <span class="c1">//revert recent changes</span>
<span class="c1">// map.keySet() is now [1,2]</span>

<span class="n">db</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</pre></div>
</div>
</div>
<div class="section" id="what-you-should-know">
<h2>What you should know<a class="headerlink" href="#what-you-should-know" title="Permalink to this headline">¶</a></h2>
<p>MapDB is very simple to use, however it bites when used in the wrong way.
Here is a list of the most common usage errors and things to avoid:</p>
<ul class="simple">
<li>Transactions (write-ahead-log) can be disabled with
<code class="docutils literal"><span class="pre">DBMaker.transactionDisable()</span></code>, this will MapDB much faster.
However, without WAL the store gets corrupted when not closed correctly.</li>
<li>Keys and values must be immutable. MapDB may serialize them on
background thread, put them into instance cache... Modifying an
object after it was stored is a bad idea.</li>
<li>MapDB is much faster with memory mapped files. But those cause problems
on 32bit JVMs and are disabled by default. Use <code class="docutils literal"><span class="pre">DBMaker.fileMmapEnableIfSupported()</span></code>
to enable them on 32bit systems.</li>
<li>There is instance cache which uses more memory, but makes MapDB faster.
Use <code class="docutils literal"><span class="pre">DBMaker.cacheHashTableEnable()</span></code></li>
<li>MapDB does not run compaction on the background. You need to call
<code class="docutils literal"><span class="pre">DB.compact()</span></code> from time to time.</li>
<li>MapDB file storage can be only opened by one user at time.
File lock should prevent file being used multiple times.
But if file lock fails to prevent it, the file will become corrupted when opened (and written into)
by multiple users.</li>
</ul>
</div>
</div>

  <div class="section">
  
  
  </div>


                <script>

if(window.location.href.indexOf('/blog/')>-1){

print('<br><br><br><hr><br><div id="disqus_thread"></div>');


/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = 'http://www.mapdb.org'; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'mapdb'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//mapdb.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();

}
</script>

            </div>
        </div>
    </div>

    <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="db-and-dbmaker.html" title="DB and DBMaker"
             >next</a> |</li>
        <li class="right" >
          <a href="foreword.html" title="Foreword"
             >previous</a> |</li>
        <li><a href="../index.html">Home</a>&nbsp;|</li>
        <li><a href="../contents.html">Documentation</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >MapDB Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2014, Jan Kotek.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>