<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>StoreDirect &mdash; MapDB</title>
    
    <link rel="stylesheet" href="../_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="MapDB" href="../" />
    <link rel="next" title="Who is using MapDB" href="../success/" />
    <link rel="prev" title="MapDB: database engine" href="../" />
  
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

<!-- google analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42074659-1', 'auto');
  ga('send', 'pageview');

</script>

  
  <link rel="alternate" type="application/atom+xml"  href="../blog/atom.xml" title="MapDB Blog">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="../">Home</a></li>
    <li><a href="../doc/getting-started/">Intro</a></li>
    <li><a href="../doc/">Docs</a></li>
    <li><a href="../blog/">Blog</a></li>
    <li><a href="https://github.com/jankotek/mapdb">Github</a></li>
  </ul>
  <div>
    <a href="../">
      <img src="../_static/logo.png" alt="MapDB" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../success/" title="Who is using MapDB"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="../" title="MapDB: database engine"
             accesskey="P">previous</a> |</li>
        <li><a href="../">Home</a>&nbsp;|</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">StoreDirect</a><ul>
<li><a class="reference internal" href="#index-page">Index page</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sorted-table-map">Sorted Table Map</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../"
                        title="previous chapter">MapDB: database engine</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../success/"
                        title="next chapter">Who is using MapDB</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/format.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="storedirect">
<h1>StoreDirect<a class="headerlink" href="#storedirect" title="Permalink to this headline">¶</a></h1>
<p>StoreDirect updates records on place. Space used by records get reused.
It keeps track of free space released deletion and reuses it.
It has zero protection from crash, all updates are written directly into store.</p>
<p>StoreDirect allocates space in &#8216;pages&#8217; of size 1MB. Operations such as <code class="docutils literal"><span class="pre">readLong</span></code>, <code class="docutils literal"><span class="pre">readByte[]</span></code>
must be aligned so they do not cross page boundaries.</p>
<div class="section" id="index-page">
<h2>Index page<a class="headerlink" href="#index-page" title="Permalink to this headline">¶</a></h2>
<p>Linked list of pages. It starts at <code class="docutils literal"><span class="pre">FIRST_INDEX_PAGE_POINTER_OFFSET</span></code> parity16.
Link to next page is at start of each page.</p>
<p>Last index page may not be completely filled. Maximal fill is indicated by Max Recid stored at <code class="docutils literal"><span class="pre">INDEX_TAIL_OFFSET</span></code> parity3+shift.</p>
<p>Index Page at start contains:</p>
<ul class="simple">
<li>first value is <strong>pointer to next index page</strong> parity16</li>
<li>TODO second value in page is <strong>checksum of all values</strong> on page</li>
</ul>
<p>Rest of the index page is filled with index values.</p>
</div>
</div>
<div class="section" id="sorted-table-map">
<h1>Sorted Table Map<a class="headerlink" href="#sorted-table-map" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal"><span class="pre">SortedTableMap</span></code> uses its own file format. File is split into page,
where page size is power of two and maximal page size 1MB.</p>
</div>

  <div class="section">
  
  
  </div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../success/" title="Who is using MapDB"
             >next</a></li>
        <li class="right" >
          <a href="../" title="MapDB: database engine"
             >previous</a> |</li>
        <li><a href="../">Home</a>&nbsp;|</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, jan.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>