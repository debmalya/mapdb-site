<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Are you running out of memory? &mdash; MapDB</title>
    
    <link rel="stylesheet" href="_static/sphinx13.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="MapDB" href="index.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css'>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

<!-- google analytics-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42074659-1', 'auto');
  ga('send', 'pageview');

</script>

  </head>
  <body>
<div class="pageheader">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="doc/getting-started.html">Intro</a></li>
    <li><a href="doc/index.html">Docs</a></li>
    <li><a href="https://github.com/jankotek/mapdb">Github</a></li>
  </ul>
  <div>
    <a href="index.html">
      <img src="_static/logo.png" alt="MapDB" />
    </a>
  </div>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="index.html">Home</a>&nbsp;|</li>
        <li><a href="contents.html">Documentation</a> &raquo;</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Are you running out of memory?</a><ul>
<li><a class="reference internal" href="#java-beyond-heap">Java beyond heap</a></li>
<li><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
<li><a class="reference internal" href="#yet-another-nosql-database">Yet another NoSQL database?</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#hello-world">Hello world</a></li>
<li><a class="reference internal" href="#what-you-should-know">What you should know</a></li>
<li><a class="reference internal" href="#support">Support</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/a-offheap.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="are-you-running-out-of-memory">
<h1>Are you running out of memory?<a class="headerlink" href="#are-you-running-out-of-memory" title="Permalink to this headline">¶</a></h1>
<div class="highlight-python"><div class="highlight"><pre>There is easy way to extend your data model to handle billions of objects.
It is so simple you won&#39;t even recognize you just went off-heap.
There is no catch, no clustering, no complexity, no extra layers...
... and it is free as a beer under Apache License.
</pre></div>
</div>
<p><strong>Warning:</strong> benchmarks and text bellow may shock you<strong>*!!!*</strong></p>
<p>It might be hard to believe technology like this exists. But keep your
mind open <em>.......</em> it took more than decade to develop it! Please give
us 10 minutes to convince you there are no boundaries.</p>
<p>It is still Data and Java, but the way it should be.. ..</p>
<div class="section" id="java-beyond-heap">
<h2>Java beyond heap<a class="headerlink" href="#java-beyond-heap" title="Permalink to this headline">¶</a></h2>
<p>Java Memory Model is great but has its limits. Create a few billions of
objects and your CPU turns to very expensive Garbage Collection truck.</p>
<p>What is the solution? Adding more memory? Adding more computers? Or just
give in and use C++?</p>
<p>Scale-up or scale-out is not always best solution. Thanks to MapDB you
can optimize, <strong>scale-in and keep Java</strong>.</p>
<p>MapDB keeps your data off-heap (or on disk). Only small recently used
fraction is on heap. Your code <em>sees</em> billions of objects, but only a
few dozens are GCable. You can also optimize and compress, so <strong>off-heap
takes smaller space</strong>.</p>
</div>
<div class="section" id="how-does-it-work">
<h2>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h2>
<p>MapDB provides Maps, Sets, Queues and Atomic Variables backed by state
of the art <strong>database engine</strong>. After more than decade of rewrites and
optimizations it emerged as <strong>alternative memory model to Java heap</strong>.</p>
<p>TODO benchmark chart with 1E9 items, MapDB versus ConcurrentHashMap</p>
<p>Now it is so fast, it even outperforms Java collections.</p>
</div>
<div class="section" id="yet-another-nosql-database">
<h2>Yet another NoSQL database?<a class="headerlink" href="#yet-another-nosql-database" title="Permalink to this headline">¶</a></h2>
<p>MapDB existed long before &#8216;NoSQL&#8217; term was born (under name JDBM). It
was originally developed as an alternative to flat binary files for
astronomical desktop application and java applets. As such it had
different requirements for complexity, overhead and speed. It evolved
separately from other DBs and has strange architecture as result.</p>
<p>It nicely combines high-level abstractions usual in Java, with tightly
optimized assembly like code. Over time it evolved into fully featured
db. Now it has optional ACID transactions, snapshots, concurrency... It
also includes stuff from ORMs such as serialization or instance cache.
All packed into 300KB jar with no other dependencies.</p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Concurrent</strong> - MapDB has record level locking and state-of-art
concurrent engine. Its performance scales nearly linearly with number
of cores. Data can be written by multiple parallel threads.</li>
<li><strong>Fast</strong> - MapDB has outstanding performance rivaled only by native
DBs. It is result of more than a decade of optimizations and
rewrites.</li>
<li><strong>ACID</strong> - MapDB optionally supports ACID transactions with full MVCC
isolation. MapDB uses write-ahead-log or append-only store for great
write durability.</li>
<li><strong>Flexible</strong> - MapDB can be used everywhere from in-memory cache to
multi-terabyte database. It also has number of options to trade
durability for write performance. This makes it very easy to
configure MapDB to exactly fit your needs.</li>
<li><strong>Hackable</strong> - MapDB is component based, most features (instance
cache, async writes, compression) are just class wrappers. It is very
easy to introduce new functionality or component into MapDB.</li>
<li><strong>SQL Like</strong> - MapDB was developed as faster alternative to SQL
engine. It has number of features which makes transition from
relational database easier: secondary indexes/collections,
autoincremental sequential ID, joints, triggers, composite keys...</li>
<li><strong>Low disk-space usage</strong> - MapDB has number of features
(serialization, delta key packing...) to minimize disk used by its
store. It also has very fast compression and custom serializers. We
take disk-usage seriously and do not waste single byte.</li>
</ul>
<p>Checkout MapDB overview. TODO link to overview page</p>
</div>
<div class="section" id="hello-world">
<h2>Hello world<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h2>
<p>MapDB is in Maven Central, add this to your pom file.:</p>
<div class="code xml highlight-python"><div class="highlight"><pre>&lt;dependency&gt;
    &lt;groupId&gt;org.mapdb&lt;/groupId&gt;
    &lt;artifactId&gt;mapdb&lt;/artifactId&gt;
&lt;/dependency&gt;
</pre></div>
</div>
<p>And run simple example:</p>
<div class="code java highlight-python"><div class="highlight"><pre>import org.mapdb.*;
ConcurrentNavigableMap treeMap = DBMaker.newTempTreeMap()

// and now use disk based Map as any other Map
treeMap.put(111,&quot;some value&quot;)
</pre></div>
</div>
<p>Now you can follow <a class="reference external" href="intro.html">10 minutes introduction</a></p>
</div>
<div class="section" id="what-you-should-know">
<h2>What you should know<a class="headerlink" href="#what-you-should-know" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Transactions (write-ahead-log) can be disabled with
DBMaker.writeAheadLogDisable(), this will speedup writes. However
without transactions store gets corrupted easily when not closed
correctly.</li>
<li>Keys and values must be immutable. MapDB may serialize them on
background thread, put them into instance cache. Modifying an object
after it was stored is a bad idea.</li>
<li>MapDB relies on memory mapped files. On 32bit JVM you will need
DBMaker.randomAccessFileEnable() configuration option to access files
larger than 2GB. This introduces overhead compared to memory mapped
files.</li>
<li>MapDB does not run defrag on background. You need to call
<tt class="docutils literal"><span class="pre">DB.compact()</span></tt> from time to time.</li>
<li>MapDB uses unchecked exceptions. All <tt class="docutils literal"><span class="pre">IOException</span></tt> are wrapped into
unchecked <tt class="docutils literal"><span class="pre">IOError</span></tt>. MapDB has weak error handling and assumes disk
failure can not be recovered at runtime. However this does not
affects data safety, if you use durable commits.</li>
</ul>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>There is <a class="reference external" href="mailto:mapdb&#37;&#52;&#48;googlegroups&#46;com">mail-group</a> with
<a class="reference external" href="http://groups.google.com/group/mapdb">archive</a>. Ask here support
questions such as &#8216;how do I open db&#8217;.</p>
<p>Anything with stack-trace should go to <a class="reference external" href="https://github.com/jankotek/MapDB/issues/new">new bug
report</a>.</p>
<p>Before creating report:</p>
<ul class="simple">
<li>check if it is not already fixed in snapshot repository</li>
<li>try alternative configurations (disable cache, disable async write
thread...)</li>
<li>try to use your own serializer, to make sure problem is not in
serializer</li>
</ul>
<p>MapDB is a hobby project and my time is limited.Please always attach
code to illustrate/reproduce your problem, so I can fix it efficiently.
For hard to reproduce problems I would strongly suggest to record JVM
execution with
<a class="reference external" href="http://www.chrononsystems.com/learn-more/products-overview">Chronon</a>
and submit the record together with a bug report. This will make sure
your bug will get fixed promptly.</p>
<p>Last option is to <a class="reference external" href="mailto:jan%20at%20kotek%20dot%20net">contact me
directly</a>. I prefer public bug
tracker and mail-group so others can find answers as well. Unless you
specify your question as confidential, I may forward it to public
mail-group.</p>
<div class="figure">
<img alt="Image" src="https://www.google-analytics.com/__utm.gif?utmac=UA-42074659-3&amp;raw=true" />
<p class="caption">Image</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="index.html">Home</a>&nbsp;|</li>
        <li><a href="contents.html">Documentation</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Jan Kotek.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>